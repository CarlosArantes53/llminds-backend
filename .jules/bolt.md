## 2026-02-22 - [Optimizing Query Sorting & Fixing Test Schemas]
**Learning:** SQLAlchemy `order_by` on a relationship uses a query like `SELECT * FROM child WHERE parent_id = ? ORDER BY sort_column`. Without a composite index on `(parent_id, sort_column)`, this requires a full scan/sort of the filtered rows. Adding this index allows the DB to return rows directly in order. Also learned that Pydantic validation errors (422) in tests often indicate that the test payload structure is outdated relative to the actual API schema, especially after schema refactors.
**Action:** Always check `__table_args__` for composite indices on relationships with `order_by`. When tests fail with 422, inspect the `schemas.py` definitions to ensure test payloads match the current API contract.
